<div ng-controller="ClientDashboardCtrl" flex layout="row">
    <md-card md-theme="light" md-theme-watch flex>
        <md-card-content layout="column">
            <div layout="row" layout-align="space-around">
                <p class="md-headline" translate>My situation</p>

                <md-input-container ng-if="clientAnrs.length > 0" class="md-block"  flex="30">
                    <label translate>Risk analysis</label>
                    <md-select ng-model="dashboard.anr">
                        <md-option ng-repeat="anr in clientAnrs" ng-value="anr.id">{{ anr['label' + anr.language] }}</md-option>
                    </md-select>
                </md-input-container>
            </div>

            <div layout="row" layout-align="center center" ng-if="dashboard.anr && dashboard.carto === undefined">
                <md-progress-circular></md-progress-circular>
            </div>

            <div layout="row" layout-align="space-around" ng-if="dashboard.anr && dashboard.carto !== undefined">
                <div layout="column" flex="35">
                    <p class="md-title" translate>Current risks map</p>

                    <table class="tbl-risk-calc">
                        <tbody>
                        <tr>
                            <th></th>
                            <th ng-repeat="mxv in dashboard.carto.real.MxV">{{ mxv }}</th>
                        </tr>
                        <tr ng-repeat="row in dashboard.carto.real.Impact">
                            <th>{{ row }}</th>
                            <td ng-class="{'green': mxv*row<=dashboard.anrData.seuil1, 'orange': mxv*row>dashboard.anrData.seuil1 && mxv*row<=dashboard.anrData.seuil2, 'red': mxv*row>dashboard.anrData.seuil2}" ng-repeat="mxv in dashboard.carto.real.MxV">{{ dashboard.carto.real.counters[row][mxv] ? dashboard.carto.real.counters[row][mxv] : 0 }}</td>
                        </tr>
                        </tbody>
                    </table>

                    <div layout="row" layout-align="center center" ng-if="dashboard.carto.real.totalDistrib">
                        <p flex="60">{{ dashboard.carto.real.distrib[0] ? dashboard.carto.real.distrib[0] : 0 }} {{ 'low risks' | translate }}</p>
                        <md-progress-linear md-mode="determinate" value="{{ dashboard.carto.real.distrib[0] * 100 / dashboard.carto.real.totalDistrib }}" class="green"></md-progress-linear>
                    </div>
                    <div layout="row" layout-align="center center" ng-if="dashboard.carto.real.totalDistrib">
                        <p flex="60">{{ dashboard.carto.real.distrib[1] ? dashboard.carto.real.distrib[1] : 0 }} {{ 'medium risks' | translate }}</p>
                        <md-progress-linear md-mode="determinate" value="{{ dashboard.carto.real.distrib[1] * 100 / dashboard.carto.real.totalDistrib }}" class="orange"></md-progress-linear>
                    </div>
                    <div layout="row" layout-align="center center" ng-if="dashboard.carto.real.totalDistrib">
                        <p flex="60">{{ dashboard.carto.real.distrib[2] ? dashboard.carto.real.distrib[2] : 0 }} {{ 'high risks' | translate }}</p>
                        <md-progress-linear md-mode="determinate" value="{{ dashboard.carto.real.distrib[2] * 100 / dashboard.carto.real.totalDistrib }}" class="red"></md-progress-linear>
                    </div>
                </div>

                <div layout="column" flex="35">
                    <p class="md-title" translate>Target risks map</p>

                    <table class="tbl-risk-calc" ng-if="dashboard.carto.targeted">
                        <tbody>
                        <tr>
                            <th></th>
                            <th ng-repeat="mxv in dashboard.carto.targeted.MxV">{{ mxv }}</th>
                        </tr>
                        <tr ng-repeat="row in dashboard.carto.targeted.Impact">
                            <th>{{ row }}</th>
                            <td ng-class="{'green': mxv*row<=dashboard.anrData.seuil1, 'orange': mxv*row>dashboard.anrData.seuil1 && mxv*row<=dashboard.anrData.seuil2, 'red': mxv*row>dashboard.anrData.seuil2}" ng-repeat="mxv in dashboard.carto.real.MxV">{{ dashboard.carto.targeted.counters[row][mxv] ? dashboard.carto.targeted.counters[row][mxv] : 0 }}</td>
                        </tr>
                        </tbody>
                    </table>

                    <div layout="row" layout-align="center center" ng-if="dashboard.carto.targeted">
                        <p flex="60">{{ dashboard.carto.targeted.distrib[0] ? dashboard.carto.targeted.distrib[0] : 0 }} {{ 'low risks' | translate }}</p>
                        <md-progress-linear md-mode="determinate" value="{{ dashboard.carto.targeted.distrib[0] * 100 / dashboard.carto.targeted.totalDistrib }}" class="green"></md-progress-linear>
                    </div>
                    <div layout="row" layout-align="center center" ng-if="dashboard.carto.targeted">
                        <p flex="60">{{ dashboard.carto.targeted.distrib[1] ? dashboard.carto.targeted.distrib[1] : 0 }} {{ 'medium risks' | translate }}</p>
                        <md-progress-linear md-mode="determinate" value="{{ dashboard.carto.targeted.distrib[1] * 100 / dashboard.carto.targeted.totalDistrib }}" class="orange"></md-progress-linear>
                    </div>
                    <div layout="row" layout-align="center center" ng-if="dashboard.carto.targeted">
                        <p flex="60">{{ dashboard.carto.targeted.distrib[2] ? dashboard.carto.targeted.distrib[2] : 0 }} {{ 'high risks' | translate }}</p>
                        <md-progress-linear md-mode="determinate" value="{{ dashboard.carto.targeted.distrib[2] * 100 / dashboard.carto.targeted.totalDistrib }}" class="red"></md-progress-linear>
                    </div>

                    <div ng-if="!dashboard.carto.targeted">
                        <p><em>{{ 'No target risks specified in your risk analysis yet.' | translate }}</em></p>
                    </div>
                </div>
            </div>

            <div ng-if="!dashboard.anr" layout-align="center center" layout="column">
                <p class="md-subhead" translate>Information about the risks in your current risk analysis will show up here.</p>
                <md-button class="md-raised md-accent" ng-click="sidebarCreateNewANR($event)"><md-icon>add</md-icon> {{ 'Create a risk analysis' | translate }}</md-button>
            </div>

            <div>&nbsp;</div>

        </md-card-content>
    </md-card>

    <!-- <div layout="column">
        <md-card md-theme="orange">
            <md-card-content>
                <p class="md-title" translate>Quick access</p>
            </md-card-content>
        </md-card>

        <md-card md-theme="light">
            <md-list>
                <md-list-item ng-disabled="!clientCurrentAnr" ui-sref="main.project.anr({modelId: clientCurrentAnr.id})">
                    <md-icon>hourglass_empty</md-icon>
                    <p ng-if="clientCurrentAnr">
                        {{ 'Current analysis' | translate }}
                    </p>
                    <p ng-if="!clientCurrentAnr">
                        <em>{{ 'No analysis yet' | translate }}</em>
                    </p>

                </md-list-item>

                <md-list-item ng-disabled="true">
                    <md-icon>list</md-icon>
                    <p translate>Check my vulnerabilities</p>
                </md-list-item>

                <md-list-item ng-href="https://securitymadein.lu/about-us/helpline/" target="_blank">
                    <md-icon>message</md-icon>
                    <p translate>Contact us</p>
                </md-list-item>
            </md-list>
        </md-card>
    </div> -->
</div>